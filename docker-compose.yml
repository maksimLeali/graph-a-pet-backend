version: '3.1'
services:
    server:
        build: ./
        command: python3 -m gunicorn --workers 4 --bind 0.0.0.0:5000 app:app
        ports:
            - 5000:5000
        depends_on:
            - postgres
        volumes:
            - .:/app
        environment:
            - FLASK_APP=app.py
            - FLASK_ENV=development

    postgres:
        image: postgres:13-alpine
        volumes:
            - postgres_data:/var/lib/postgresql/data/
        ports:
            - "5432:5432"
        environment:
            - POSTGRES_USER=myuser
            - POSTGRES_PASSWORD=password
            - POSTGRES_DB=pet-finder
volumes:
  postgres_data: